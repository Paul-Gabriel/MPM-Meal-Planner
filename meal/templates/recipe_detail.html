<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ recipe.name }} - Recipe</title>
    <link rel="stylesheet" href="/static/style.css?ts={{ time }}">
    <link rel="icon" type="image/png" href="/static/icons/logo.png">
    <style>
        .recipe-container { max-width: 1000px; margin: 30px auto; background: rgba(255,255,255,0.9); padding: 30px 40px; border-radius: 16px; box-shadow: 0 10px 28px rgba(0,0,0,0.18); font-family: Arial, sans-serif; }
        .recipe-header { display:flex; gap:40px; align-items:flex-start; flex-wrap:wrap; }
        .recipe-header img { max-width:340px; border-radius:14px; object-fit:cover; box-shadow:0 4px 14px rgba(0,0,0,0.25); }
        .recipe-meta h1 { margin:0 0 10px; font-size:2.1rem; color:#2c3e50; }
        .tag { display:inline-block; background:#ff9800; color:#fff; padding:4px 10px; margin: 3px 5px 0 0; border-radius: 20px; font-size:0.7rem; letter-spacing:0.5px; text-transform:uppercase; }
        .sections { margin-top:30px; display:grid; grid-template-columns: 1fr 1fr; gap:40px; }
        @media (max-width: 900px){ .sections{ grid-template-columns:1fr; } }
        table.ingredients { width:100%; border-collapse:collapse; font-size:0.9rem; }
        table.ingredients th { text-align:left; background:#ff9800; color:#fff; padding:8px 10px; }
        table.ingredients td { padding:6px 10px; border-bottom:1px solid #eee; }
        ol.steps { counter-reset: step; list-style:none; padding-left:0; }
        ol.steps li { position:relative; margin:0 0 14px; padding:12px 14px 12px 50px; background:#fafafa; border:1px solid #e2e2e2; border-radius:10px; line-height:1.4; }
        ol.steps li:before { counter-increment: step; content: counter(step); position:absolute; left:12px; top:10px; width:28px; height:28px; background:#ff9800; color:#fff; font-weight:bold; font-size:0.9rem; display:flex; align-items:center; justify-content:center; border-radius:50%; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
        .back-nav { margin-top:10px; }
        .back-nav a { text-decoration:none; color:#fff; background:#2c3e50; padding:8px 16px; border-radius:6px; font-size:0.85rem; }
        .servings { font-size:0.9rem; color:#555; margin:4px 0 8px; }
        .nutrition { margin-top:12px; font-size:0.8rem; background:#f6f8fa; border:1px solid #e2e2e2; padding:10px 14px; border-radius:10px; line-height:1.3; max-width:340px; }
        .nutrition h3 { margin:0 0 6px; font-size:0.95rem; color:#2c3e50; }
        .nutrition .macro-bar { display:flex; gap:8px; flex-wrap:wrap; }
        .nutrition .chip { background:#ff9800; color:#fff; padding:4px 8px; border-radius:14px; font-size:0.65rem; letter-spacing:0.5px; }
    </style>
</head>
<body class="bg">
    <div class="recipe-container">
        <div class="back-nav"><a href="/recipes-page">&larr; All Recipes</a></div>
        <div class="recipe-header">
            <div>
                <img src="/static/pictures/{{ recipe.image or (recipe.name.lower().replace(' ', '_') + '.jpg') }}" alt="{{ recipe.name }}" onerror="this.onerror=null;this.src='/static/pictures/placeholder.jpg';">
            </div>
            <div class="recipe-meta">
                <h1>{{ recipe.name }}</h1>
                <div class="servings">Servings: <strong>{{ recipe.servings }}</strong></div>
                <div>
                    {% for tag in tags %}
                        <span class="tag">{{ tag }}</span>
                    {% endfor %}
                </div>
                {% if calories or macros %}
                <div class="nutrition">
                    <h3>Nutrition</h3>
                    {% if calories %}
                        <div><strong>Calories / serving:</strong> {{ calories }} kcal</div>
                    {% endif %}
                    <div class="macro-bar">
                        {% if macros.protein is not none %}<span class="chip">Protein {{ macros.protein }}g</span>{% endif %}
                        {% if macros.carbs is not none %}<span class="chip">Carbs {{ macros.carbs }}g</span>{% endif %}
                        {% if macros.fats is not none %}<span class="chip">Fats {{ macros.fats }}g</span>{% endif %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
        <div class="sections">
            <div>
                <h2 style="margin-top:0; color:#2c3e50;">Ingredients</h2>
                <table class="ingredients">
                    <thead>
                        <tr><th>Name</th><th style="width:110px;">Quantity</th></tr>
                    </thead>
                    <tbody>
                        {% for ing in ingredients %}
                        <tr>
                            <td>{{ ing.name }}</td>
                            <td>{{ ing.quantity }} {{ ing.unit }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div>
                <h2 style="margin-top:0; color:#2c3e50;">Steps</h2>
                {% if steps %}
                <ol class="steps">
                    {% for s in steps %}
                        <li>{{ s }}</li>
                    {% endfor %}
                </ol>
                {% else %}
                    <p>No steps provided for this recipe.</p>
                {% endif %}
            </div>
        </div>
    </div>
</body>
</html>
